<div class="container">
  <h1>Google Places Autocomplete</h1>

  @if (!apiKeyReady()) {
    <p class="subtitle">
      Enter your Google Places API key to get started. You can get one from the
      <a href="https://console.cloud.google.com/apis/credentials" target="_blank">Google Cloud Console</a>
      with the <strong>Places API (New)</strong> enabled.
    </p>

    <div class="api-key-form">
      <div class="form-group">
        <label for="apiKey">API Key</label>
        <input
          id="apiKey"
          type="text"
          [(ngModel)]="apiKeyInput"
          placeholder="Enter your Google Places API key..."
          (keydown.enter)="submitApiKey()"
        />
      </div>
      <button (click)="submitApiKey()" [disabled]="!apiKeyInput.trim()">
        Load Places API
      </button>
    </div>
  } @else {
    <p class="subtitle">
      Start typing a US address in the Street Address field to see suggestions.
    </p>

    <form [formGroup]="form" class="address-form">
      <div class="form-group">
        <label for="street">Street Address</label>
        <input
          id="street"
          type="text"
          formControlName="streetAddress"
          libGooglePlaces
          (placeChanged)="onAddressSelected($event)"
          placeholder="Start typing an address..."
        />
      </div>

      <div class="form-row">
        <div class="form-group">
          <label for="city">City</label>
          <input
            id="city"
            type="text"
            formControlName="city"
            placeholder="City"
          />
        </div>

        <div class="form-group form-group-sm">
          <label for="state">State</label>
          <input
            id="state"
            type="text"
            formControlName="state"
            placeholder="State"
          />
        </div>

        <div class="form-group form-group-sm">
          <label for="zip">Zip Code</label>
          <input
            id="zip"
            type="text"
            formControlName="zipCode"
            placeholder="Zip"
          />
        </div>
      </div>
    </form>

    @if (selectedAddress) {
      <div class="result-card">
        <h3>Parsed Address Data</h3>
        <pre>{{ selectedAddress | json }}</pre>
      </div>
    }
  }
</div>
